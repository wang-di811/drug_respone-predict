2025-03-18 10:09:52,332 - DrugResponse - INFO - 日志设置完成，日志文件位置: logs\drug_response_prediction_20250318_100952.log
2025-03-18 10:09:52,332 - DrugResponse - INFO - 开始药物反应预测任务 - 五折交叉验证
2025-03-18 10:09:52,948 - DrugResponse - INFO - 使用设备: cuda
2025-03-18 10:09:53,036 - DrugResponse.DataLoader - INFO - 正在加载和预处理数据...
2025-03-18 10:10:02,229 - DrugResponse.DataLoader - INFO - 数据加载完成: 特征数量 725, 样本数量 470843
2025-03-18 10:10:02,241 - DrugResponse.CrossValidation - INFO - 创建5折交叉验证数据集
2025-03-18 10:10:02,241 - DrugResponse.CrossValidation - INFO - 使用drug_name进行分层抽样
2025-03-18 10:10:02,997 - DrugResponse.CrossValidation - INFO - 处理第1折
2025-03-18 10:10:13,875 - DrugResponse.CrossValidation - INFO - 第1折数据准备完成 - 训练集: 376674样本, 验证集: 94169样本
2025-03-18 10:10:13,890 - DrugResponse.CrossValidation - INFO - 处理第2折
2025-03-18 10:10:27,252 - DrugResponse.CrossValidation - INFO - 第2折数据准备完成 - 训练集: 376674样本, 验证集: 94169样本
2025-03-18 10:10:27,272 - DrugResponse.CrossValidation - INFO - 处理第3折
2025-03-18 10:10:41,816 - DrugResponse.CrossValidation - INFO - 第3折数据准备完成 - 训练集: 376674样本, 验证集: 94169样本
2025-03-18 10:10:41,922 - DrugResponse.CrossValidation - INFO - 处理第4折
2025-03-18 10:10:53,858 - DrugResponse.CrossValidation - INFO - 第4折数据准备完成 - 训练集: 376675样本, 验证集: 94168样本
2025-03-18 10:10:53,868 - DrugResponse.CrossValidation - INFO - 处理第5折
2025-03-18 10:11:03,797 - DrugResponse.CrossValidation - INFO - 第5折数据准备完成 - 训练集: 376675样本, 验证集: 94168样本
2025-03-18 10:11:03,908 - DrugResponse.CVTrainer - INFO - 开始5折交叉验证训练和评估
2025-03-18 10:11:03,996 - DrugResponse.CVTrainer - INFO - ===== 第1折 =====
2025-03-18 10:11:04,000 - DrugResponse.ModelFactory - INFO - 创建MLP模型: 输入维度 725, 隐藏层 [512, 256, 128, 64]
2025-03-18 10:11:06,782 - DrugResponse.Trainer - INFO - 开始训练模型，共200个epoch，使用设备: cuda
2025-03-18 10:12:15,190 - DrugResponse.Trainer - INFO - Epoch 1/200 - Train Loss: 7.0954, Val Loss: 6.9962, Time: 67.65s
2025-03-18 10:12:15,211 - DrugResponse.Trainer - INFO - 保存最佳模型，验证损失: 6.9962
2025-03-18 10:13:04,152 - DrugResponse.Trainer - INFO - Epoch 2/200 - Train Loss: 7.0510, Val Loss: 6.9896, Time: 48.94s
2025-03-18 10:13:04,193 - DrugResponse.Trainer - INFO - 保存最佳模型，验证损失: 6.9896
2025-03-18 10:13:56,237 - DrugResponse.Trainer - INFO - Epoch 3/200 - Train Loss: 7.0392, Val Loss: 6.9895, Time: 52.04s
2025-03-18 10:13:56,257 - DrugResponse.Trainer - INFO - 保存最佳模型，验证损失: 6.9895
2025-03-18 10:14:46,634 - DrugResponse.Trainer - INFO - Epoch 4/200 - Train Loss: 7.0265, Val Loss: 6.9944, Time: 50.38s
2025-03-18 10:15:39,022 - DrugResponse.Trainer - INFO - Epoch 5/200 - Train Loss: 7.0133, Val Loss: 6.9965, Time: 52.39s
2025-03-18 10:16:28,721 - DrugResponse.Trainer - INFO - Epoch 6/200 - Train Loss: 7.0069, Val Loss: 6.9893, Time: 49.70s
2025-03-18 10:16:28,740 - DrugResponse.Trainer - INFO - 保存最佳模型，验证损失: 6.9893
2025-03-18 10:17:24,247 - DrugResponse.Trainer - INFO - Epoch 7/200 - Train Loss: 6.9989, Val Loss: 6.9858, Time: 55.51s
2025-03-18 10:17:24,297 - DrugResponse.Trainer - INFO - 保存最佳模型，验证损失: 6.9858
2025-03-18 10:18:28,599 - DrugResponse.Trainer - INFO - Epoch 8/200 - Train Loss: 6.9997, Val Loss: 6.9871, Time: 64.30s
2025-03-18 10:19:17,784 - DrugResponse.Trainer - INFO - Epoch 9/200 - Train Loss: 6.9970, Val Loss: 6.9918, Time: 49.19s
2025-03-18 10:20:10,375 - DrugResponse.Trainer - INFO - Epoch 10/200 - Train Loss: 6.9968, Val Loss: 7.0096, Time: 52.59s
2025-03-18 10:21:02,574 - DrugResponse.Trainer - INFO - Epoch 11/200 - Train Loss: 6.9968, Val Loss: 6.9861, Time: 52.20s
2025-03-18 10:21:54,410 - DrugResponse.Trainer - INFO - Epoch 12/200 - Train Loss: 6.9980, Val Loss: 6.9879, Time: 51.84s
2025-03-18 10:23:06,732 - DrugResponse.Trainer - INFO - Epoch 13/200 - Train Loss: 6.9940, Val Loss: 6.9925, Time: 72.32s
2025-03-18 10:23:57,910 - DrugResponse.Trainer - INFO - Epoch 14/200 - Train Loss: 6.9885, Val Loss: 6.9852, Time: 51.17s
2025-03-18 10:23:57,928 - DrugResponse.Trainer - INFO - 保存最佳模型，验证损失: 6.9852
2025-03-18 10:24:47,970 - DrugResponse.Trainer - INFO - Epoch 15/200 - Train Loss: 6.9844, Val Loss: 6.9860, Time: 50.04s
2025-03-18 10:25:41,174 - DrugResponse.Trainer - INFO - Epoch 16/200 - Train Loss: 6.9854, Val Loss: 7.0108, Time: 53.20s
2025-03-18 10:26:31,373 - DrugResponse.Trainer - INFO - Epoch 17/200 - Train Loss: 6.9849, Val Loss: 7.0230, Time: 50.20s
2025-03-18 10:27:23,626 - DrugResponse.Trainer - INFO - Epoch 18/200 - Train Loss: 6.9869, Val Loss: 6.9862, Time: 52.25s
2025-03-18 10:28:14,288 - DrugResponse.Trainer - INFO - Epoch 19/200 - Train Loss: 6.9827, Val Loss: 7.0055, Time: 50.66s
2025-03-18 10:29:02,247 - DrugResponse.Trainer - INFO - Epoch 20/200 - Train Loss: 6.9859, Val Loss: 6.9864, Time: 47.96s
2025-03-18 10:30:03,821 - DrugResponse.Trainer - INFO - Epoch 21/200 - Train Loss: 6.9796, Val Loss: 6.9900, Time: 61.57s
2025-03-18 10:31:09,185 - DrugResponse.Trainer - INFO - Epoch 22/200 - Train Loss: 6.9801, Val Loss: 6.9929, Time: 65.36s
2025-03-18 10:32:37,501 - DrugResponse.Trainer - INFO - Epoch 23/200 - Train Loss: 6.9844, Val Loss: 7.0137, Time: 88.32s
2025-03-18 10:34:33,726 - DrugResponse.Trainer - INFO - Epoch 24/200 - Train Loss: 6.9803, Val Loss: 6.9861, Time: 116.22s
2025-03-18 10:34:33,726 - DrugResponse.Trainer - INFO - 早停激活，10个epoch内未改善验证损失
2025-03-18 10:34:33,726 - DrugResponse.Trainer - INFO - 训练完成，总时间: 1406.19秒
2025-03-18 10:34:33,853 - DrugResponse.Trainer - INFO - 已加载最佳模型
2025-03-18 10:34:36,052 - DrugResponse.Evaluator - INFO - 开始在测试集上评估模型
