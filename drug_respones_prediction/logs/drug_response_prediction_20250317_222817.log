2025-03-17 22:28:17,886 - DrugResponse - INFO - 日志设置完成，日志文件位置: logs\drug_response_prediction_20250317_222817.log
2025-03-17 22:28:17,886 - DrugResponse - INFO - 开始药物反应预测任务 - 五折交叉验证
2025-03-17 22:28:19,446 - DrugResponse - INFO - 使用设备: cuda
2025-03-17 22:28:19,483 - DrugResponse.DataLoader - INFO - 正在加载和预处理数据...
2025-03-17 22:28:23,071 - DrugResponse.DataLoader - INFO - 数据加载完成: 特征数量 725, 样本数量 470843
2025-03-17 22:28:23,072 - DrugResponse.CrossValidation - INFO - 创建5折交叉验证数据集
2025-03-17 22:28:23,072 - DrugResponse.CrossValidation - INFO - 使用drug_name进行分层抽样
2025-03-17 22:28:23,419 - DrugResponse.CrossValidation - INFO - 处理第1折
2025-03-17 22:28:35,221 - DrugResponse.CrossValidation - INFO - 第1折数据准备完成 - 训练集: 376674样本, 验证集: 94169样本
2025-03-17 22:28:35,238 - DrugResponse.CrossValidation - INFO - 处理第2折
2025-03-17 22:28:50,550 - DrugResponse.CrossValidation - INFO - 第2折数据准备完成 - 训练集: 376674样本, 验证集: 94169样本
2025-03-17 22:28:50,560 - DrugResponse.CrossValidation - INFO - 处理第3折
2025-03-17 22:28:56,307 - DrugResponse.CrossValidation - INFO - 第3折数据准备完成 - 训练集: 376674样本, 验证集: 94169样本
2025-03-17 22:28:56,312 - DrugResponse.CrossValidation - INFO - 处理第4折
2025-03-17 22:29:02,393 - DrugResponse.CrossValidation - INFO - 第4折数据准备完成 - 训练集: 376675样本, 验证集: 94168样本
2025-03-17 22:29:02,402 - DrugResponse.CrossValidation - INFO - 处理第5折
2025-03-17 22:29:09,546 - DrugResponse.CrossValidation - INFO - 第5折数据准备完成 - 训练集: 376675样本, 验证集: 94168样本
2025-03-17 22:29:09,643 - DrugResponse.CVTrainer - INFO - 开始5折交叉验证训练和评估
2025-03-17 22:29:09,704 - DrugResponse.CVTrainer - INFO - ===== 第1折 =====
2025-03-17 22:29:09,705 - DrugResponse.ModelFactory - INFO - 创建MLP模型: 输入维度 725, 隐藏层 [512, 256, 128, 64]
2025-03-17 22:29:12,347 - DrugResponse.Trainer - INFO - 开始训练模型，共200个epoch，使用设备: cuda
2025-03-17 22:29:38,178 - DrugResponse.Trainer - INFO - Epoch 1/200 - Train Loss: 7.0716, Val Loss: 6.9966, Time: 25.28s
2025-03-17 22:29:38,193 - DrugResponse.Trainer - INFO - 保存最佳模型，验证损失: 6.9966
2025-03-17 22:29:59,786 - DrugResponse.Trainer - INFO - Epoch 2/200 - Train Loss: 7.0532, Val Loss: 6.9915, Time: 21.59s
2025-03-17 22:29:59,798 - DrugResponse.Trainer - INFO - 保存最佳模型，验证损失: 6.9915
