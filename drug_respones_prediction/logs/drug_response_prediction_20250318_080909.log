2025-03-18 08:09:09,869 - DrugResponse - INFO - 日志设置完成，日志文件位置: logs\drug_response_prediction_20250318_080909.log
2025-03-18 08:09:09,870 - DrugResponse - INFO - 开始药物反应预测任务 - 五折交叉验证
2025-03-18 08:09:11,555 - DrugResponse - INFO - 使用设备: cuda
2025-03-18 08:09:11,667 - DrugResponse.DataLoader - INFO - 正在加载和预处理数据...
2025-03-18 08:09:18,138 - DrugResponse.DataLoader - INFO - 数据加载完成: 特征数量 725, 样本数量 470843
2025-03-18 08:09:18,138 - DrugResponse.CrossValidation - INFO - 创建5折交叉验证数据集
2025-03-18 08:09:18,138 - DrugResponse.CrossValidation - INFO - 使用drug_name进行分层抽样
2025-03-18 08:09:18,955 - DrugResponse.CrossValidation - INFO - 处理第1折
2025-03-18 08:09:26,174 - DrugResponse.CrossValidation - INFO - 第1折数据准备完成 - 训练集: 376674样本, 验证集: 94169样本
2025-03-18 08:09:26,183 - DrugResponse.CrossValidation - INFO - 处理第2折
2025-03-18 08:09:36,574 - DrugResponse.CrossValidation - INFO - 第2折数据准备完成 - 训练集: 376674样本, 验证集: 94169样本
2025-03-18 08:09:36,591 - DrugResponse.CrossValidation - INFO - 处理第3折
2025-03-18 08:09:48,336 - DrugResponse.CrossValidation - INFO - 第3折数据准备完成 - 训练集: 376674样本, 验证集: 94169样本
2025-03-18 08:09:48,351 - DrugResponse.CrossValidation - INFO - 处理第4折
2025-03-18 08:09:57,104 - DrugResponse.CrossValidation - INFO - 第4折数据准备完成 - 训练集: 376675样本, 验证集: 94168样本
2025-03-18 08:09:57,118 - DrugResponse.CrossValidation - INFO - 处理第5折
2025-03-18 08:10:07,645 - DrugResponse.CrossValidation - INFO - 第5折数据准备完成 - 训练集: 376675样本, 验证集: 94168样本
2025-03-18 08:10:07,755 - DrugResponse.CVTrainer - INFO - 开始5折交叉验证训练和评估
2025-03-18 08:10:07,840 - DrugResponse.CVTrainer - INFO - ===== 第1折 =====
2025-03-18 08:10:07,841 - DrugResponse.ModelFactory - INFO - 创建MLP模型: 输入维度 725, 隐藏层 [512, 256, 128, 64]
2025-03-18 08:10:10,204 - DrugResponse.Trainer - INFO - 开始训练模型，共200个epoch，使用设备: cuda
2025-03-18 08:11:00,707 - DrugResponse.Trainer - INFO - Epoch 1/200 - Train Loss: 7.0782, Val Loss: 6.9936, Time: 48.66s
2025-03-18 08:11:00,726 - DrugResponse.Trainer - INFO - 保存最佳模型，验证损失: 6.9936
2025-03-18 08:11:52,596 - DrugResponse.Trainer - INFO - Epoch 2/200 - Train Loss: 7.0404, Val Loss: 6.9870, Time: 51.87s
2025-03-18 08:11:52,612 - DrugResponse.Trainer - INFO - 保存最佳模型，验证损失: 6.9870
2025-03-18 08:12:44,406 - DrugResponse.Trainer - INFO - Epoch 3/200 - Train Loss: 7.0305, Val Loss: 7.0243, Time: 51.79s
2025-03-18 08:13:33,192 - DrugResponse.Trainer - INFO - Epoch 4/200 - Train Loss: 7.0179, Val Loss: 6.9919, Time: 48.79s
2025-03-18 08:14:25,447 - DrugResponse.Trainer - INFO - Epoch 5/200 - Train Loss: 7.0051, Val Loss: 6.9862, Time: 52.25s
2025-03-18 08:14:25,462 - DrugResponse.Trainer - INFO - 保存最佳模型，验证损失: 6.9862
2025-03-18 08:15:15,610 - DrugResponse.Trainer - INFO - Epoch 6/200 - Train Loss: 6.9984, Val Loss: 6.9907, Time: 50.15s
2025-03-18 08:16:09,745 - DrugResponse.Trainer - INFO - Epoch 7/200 - Train Loss: 6.9986, Val Loss: 6.9899, Time: 54.14s
2025-03-18 08:16:53,427 - DrugResponse.Trainer - INFO - Epoch 8/200 - Train Loss: 7.0000, Val Loss: 6.9905, Time: 43.68s
2025-03-18 08:17:44,103 - DrugResponse.Trainer - INFO - Epoch 9/200 - Train Loss: 6.9974, Val Loss: 6.9874, Time: 50.68s
2025-03-18 08:18:47,543 - DrugResponse.Trainer - INFO - Epoch 10/200 - Train Loss: 6.9936, Val Loss: 7.0103, Time: 63.44s
2025-03-18 08:20:39,377 - DrugResponse.Trainer - INFO - Epoch 11/200 - Train Loss: 6.9930, Val Loss: 6.9901, Time: 111.83s
2025-03-18 08:21:31,219 - DrugResponse.Trainer - INFO - Epoch 12/200 - Train Loss: 6.9860, Val Loss: 6.9915, Time: 51.84s
2025-03-18 08:22:21,769 - DrugResponse.Trainer - INFO - Epoch 13/200 - Train Loss: 6.9914, Val Loss: 6.9863, Time: 50.55s
2025-03-18 08:23:12,720 - DrugResponse.Trainer - INFO - Epoch 14/200 - Train Loss: 6.9836, Val Loss: 6.9871, Time: 50.95s
2025-03-18 08:24:02,615 - DrugResponse.Trainer - INFO - Epoch 15/200 - Train Loss: 6.9843, Val Loss: 6.9883, Time: 49.89s
2025-03-18 08:24:02,615 - DrugResponse.Trainer - INFO - 早停激活，10个epoch内未改善验证损失
2025-03-18 08:24:02,616 - DrugResponse.Trainer - INFO - 训练完成，总时间: 830.57秒
2025-03-18 08:24:02,675 - DrugResponse.Trainer - INFO - 已加载最佳模型
2025-03-18 08:24:03,247 - DrugResponse.Evaluator - INFO - 开始在测试集上评估模型
2025-03-18 09:36:27,060 - DrugResponse.Evaluator - INFO - 测试集损失: 6.9862
2025-03-18 09:36:27,061 - DrugResponse.Evaluator - INFO - 测试集 MAE: 2.0625
2025-03-18 09:36:27,086 - DrugResponse.Evaluator - INFO - 测试集 RMSE: 2.6461
2025-03-18 09:36:27,102 - DrugResponse.Evaluator - INFO - 测试集 Pearson相关系数: -0.1086
2025-03-18 09:36:27,102 - DrugResponse.Evaluator - INFO - 测试集 Spearman等级相关系数: -0.0734
2025-03-18 09:36:27,102 - DrugResponse.Evaluator - INFO - 测试集 MAPE: 450.56%
2025-03-18 09:36:27,102 - DrugResponse.Evaluator - INFO - 测试集 一致性指数(CI): 0.4789
2025-03-18 09:36:28,128 - DrugResponse.CVTrainer - INFO - 保存第1折模型到 results\cv_20250318_081007\fold_1_model.pth
2025-03-18 09:36:28,128 - DrugResponse.CVTrainer - INFO - ===== 第2折 =====
2025-03-18 09:36:28,132 - DrugResponse.ModelFactory - INFO - 创建MLP模型: 输入维度 725, 隐藏层 [512, 256, 128, 64]
2025-03-18 09:36:28,142 - DrugResponse.Trainer - INFO - 开始训练模型，共200个epoch，使用设备: cuda
2025-03-18 09:37:11,144 - DrugResponse.Trainer - INFO - Epoch 1/200 - Train Loss: 7.0634, Val Loss: 7.0573, Time: 42.99s
2025-03-18 09:37:11,152 - DrugResponse.Trainer - INFO - 保存最佳模型，验证损失: 7.0573
2025-03-18 09:37:52,312 - DrugResponse.Trainer - INFO - Epoch 2/200 - Train Loss: 7.0348, Val Loss: 7.0640, Time: 41.16s
2025-03-18 09:38:34,631 - DrugResponse.Trainer - INFO - Epoch 3/200 - Train Loss: 7.0230, Val Loss: 7.0552, Time: 42.31s
2025-03-18 09:38:34,639 - DrugResponse.Trainer - INFO - 保存最佳模型，验证损失: 7.0552
2025-03-18 09:39:20,052 - DrugResponse.Trainer - INFO - Epoch 4/200 - Train Loss: 7.0160, Val Loss: 7.0554, Time: 45.41s
2025-03-18 09:40:06,468 - DrugResponse.Trainer - INFO - Epoch 5/200 - Train Loss: 7.0050, Val Loss: 7.0626, Time: 46.42s
2025-03-18 09:40:52,227 - DrugResponse.Trainer - INFO - Epoch 6/200 - Train Loss: 6.9942, Val Loss: 7.0541, Time: 45.75s
2025-03-18 09:40:52,254 - DrugResponse.Trainer - INFO - 保存最佳模型，验证损失: 7.0541
2025-03-18 09:41:43,574 - DrugResponse.Trainer - INFO - Epoch 7/200 - Train Loss: 6.9903, Val Loss: 7.1028, Time: 51.32s
2025-03-18 09:42:33,475 - DrugResponse.Trainer - INFO - Epoch 8/200 - Train Loss: 6.9887, Val Loss: 7.0569, Time: 49.90s
2025-03-18 09:43:21,788 - DrugResponse.Trainer - INFO - Epoch 9/200 - Train Loss: 6.9882, Val Loss: 7.0549, Time: 48.31s
2025-03-18 09:44:09,606 - DrugResponse.Trainer - INFO - Epoch 10/200 - Train Loss: 6.9851, Val Loss: 7.0732, Time: 47.82s
2025-03-18 09:44:59,563 - DrugResponse.Trainer - INFO - Epoch 11/200 - Train Loss: 6.9850, Val Loss: 7.0586, Time: 49.96s
2025-03-18 09:45:51,295 - DrugResponse.Trainer - INFO - Epoch 12/200 - Train Loss: 6.9864, Val Loss: 7.0954, Time: 51.73s
2025-03-18 09:46:39,246 - DrugResponse.Trainer - INFO - Epoch 13/200 - Train Loss: 6.9744, Val Loss: 7.0538, Time: 47.95s
2025-03-18 09:46:39,262 - DrugResponse.Trainer - INFO - 保存最佳模型，验证损失: 7.0538
2025-03-18 09:47:29,764 - DrugResponse.Trainer - INFO - Epoch 14/200 - Train Loss: 6.9745, Val Loss: 7.0788, Time: 50.50s
